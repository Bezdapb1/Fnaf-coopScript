-- FNAF 1 Script Complete - ESP + Auto Door + Speed Hack + Anti-Jumpscare
-- Modified BY:@Slippyar
-- Version: 1.8.0 - Key Protection System
-- Auto Door INTELIGENTE + Anti-Jumpscare 

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

local LocalPlayer = Players.LocalPlayer
local espEnabled = false
local fullbrightEnabled = false
local autoDoorEnabled = false
local speedHackEnabled = false
local antiJumpscareEnabled = false
local highlights = {}
local originalLighting = {}
local originalSpeed = 16
local currentSpeed = 16
local doorStates = {Left = false, Right = false}
local doorCooldowns = {Left = 0, Right = 0}
local jumpscareObjects = {}
local activeTweens = {}
local debugMode = false

-- Ключ для активации
local REQUIRED_KEY = "JFoefw!0"
local scriptActivated = false

-- Ссылка для получения ключа
local KEY_LINK = "https://direct-link.net/2497825/GzpMUKgnM1bs"

-- Distâncias CONFIGURÁVEIS - Sistema Personalizado
local CLOSE_DISTANCE_NORMAL = 16
local SAFE_DISTANCE_NORMAL = 18
local CLOSE_DISTANCE_FOXY = 40
local SAFE_DISTANCE_FOXY = 70

-- Система координатного обнаружения
local detectionThreshold = 0.5
local detectionTime = 3.0

-- Исправленная система для Фокси
local FOXY_ATTACK_DURATION = 6.0
local foxyAttackStartTime = 0
local foxyAttackActive = false
local foxyLastDistance = math.huge

-- Координаты для телепортации
local DOOR_COORDINATES = {
    Left = {
        playerPos = Vector3.new(9.5, 4.0, -81.9),
        cameraPos = Vector3.new(9.0, 5.62, -81.9),
        yawAngle = 277.5,
        yawRadians = math.rad(277.5)
    },
    Right = {
        playerPos = Vector3.new(47, 4.0, -81.9),
        cameraPos = Vector3.new(5.2, 5.5, -81.9),
        yawAngle = 85.9,
        yawRadians = math.rad(85.9)
    }
}

-- Координаты аниматроников
local animatronicPositions = {
    Chica = {
        safePositions = {
            {X = -7.8, Y = 4.0, Z = -85.5}
        },
        dangerPositions = {
            {X = -2.3, Y = 4.0, Z = -71.9}
        }
    },
    
    Bonnie = {
        safePositions = {
            {X = 16.9, Y = 4.0, Z = -86.7}
        },
        dangerPositions = {
            {X = 15.3, Y = 4.0, Z = -70.7}
        }
    },
    
    Freddy = {
        safePositions = {},
        dangerPositions = {
            {X = -7.8, Y = 4.0, Z = -85.5},
            {X = 16.9, Y = 4.0, Z = -86.7},
            {X = 15.3, Y = 4.0, Z = -70.7},
            {X = -2.3, Y = 4.0, Z = -71.9}
        }
    }
}

-- Таймеры для обнаружения
local detectionTimers = {
    Chica = {dangerTimer = 0, lastPosition = nil},
    Bonnie = {dangerTimer = 0, lastPosition = nil},
    Freddy = {dangerTimer = 0, lastPosition = nil}
}

-- Lista de animatronics FNAF 1
local animatronicsWithJumpscares = {
    "Chica",
    "Bonnie", 
    "Freddy",
    "Foxy"
}

-- Lista de animatronics para ESP e Auto Door
local animatronics = {
    {name = "Bonnie", target = "BonnieNPC", side = "Left", isFoxy = false},
    {name = "Bonnie", target = "StageCylinder", side = "Left", isFoxy = false},
    {name = "Foxy", target = "FoxyNPC", side = "Left", isFoxy = true},
    {name = "Foxy", target = "Foxy", side = "Left", isFoxy = true},
    {name = "Chica", target = "ChicaNPC", side = "Right", isFoxy = false},
    {name = "Freddy", target = "FreddyNPC", side = "Right", isFoxy = false}
}

-- СИСТЕМА ЯЗЫКОВ - ИСПРАВЛЕННАЯ
local Languages = {
    Russian = {
        ShortName = "RUS",
        TITLE = "FNAF 1 Скрипт v1.8.0",
        ESP_OFF = "ESP: ВЫКЛ",
        ESP_ON = "ESP: ВКЛ",
        FULLBRIGHT_OFF = "Яркость: ВЫКЛ",
        FULLBRIGHT_ON = "Яркость: ВКЛ",
        AUTODOOR_OFF = "Авто-двери: ВЫКЛ",
        AUTODOOR_ON = "Авто-двери: ВКЛ",
        ANTIJUMP_OFF = "Анти-скример: ВЫКЛ",
        ANTIJUMP_ON = "Анти-скример: ВКЛ",
        SPEED_HACK = "Скорость",
        SPEED_PLACEHOLDER = "Скорость...",
        CONFIG_DOORS = "Настройки дверей",
        READY = "Готов",
        STATUS = "Статус",
        BY = "BY:Slippy v1.8.0",
        KEY_REQUIRED = "Требуется ключ",
        KEY_PLACEHOLDER = "Введите ключ...",
        GET_KEY = "Получить ключ",
        ACTIVATE = "Активировать",
        INVALID_KEY = "Неверный ключ!",
        ACTIVATION_SUCCESS = "Активация успешна!",
        COPY_LINK = "Скопировать ссылку",
        LINK_COPIED = "Ссылка скопирована!",
        GET_KEY_INFO = "Нажмите чтобы скопировать ссылку для получения ключа",
        
        CONFIG_TITLE = "Настройка дверей",
        NORMAL_CLOSE = "Закрыть дверь (обычно):",
        NORMAL_OPEN = "Открыть дверь (обычно):",
        FOXY_CLOSE = "Закрыть дверь (Фокси):",
        FOXY_OPEN = "Открыть дверь (Фокси):",
        APPLY = "Применить",
        RESET = "Сбросить",
        
        ESP_ENABLED = "ESP включен",
        ESP_DISABLED = "ESP выключен",
        FULLBRIGHT_ENABLED = "Яркость включена",
        FULLBRIGHT_DISABLED = "Яркость выключена",
        AUTODOOR_ENABLED = "Авто-двери активны\nСледим...",
        AUTODOOR_DISABLED = "Авто-двери выключены",
        ANTIJUMP_ENABLED = "Анти-скример включен",
        ANTIJUMP_DISABLED = "Анти-скример выключен",
        SPEED_APPLIED = "Скорость: %d",
        SPEED_RESET = "Скорость сброшена",
        CONFIG_APPLIED = "Настройки применены!",
        CONFIG_RESET = "Настройки сброшены",
        
        NO_GAMETRIGGERS = "GameTriggers не найден!",
        NO_JUMPSCARES = "Папка Jumpscares не найдена!",
        DOOR_CLOSED = "%s обнаружен!\n%.0f юнитов - %s ДВЕРЬ ЗАКРЫТА",
        FOXY_DETECTED = "%s (ФОКСИ!)\n%.0f юнитов - ЛЕВАЯ ДВЕРЬ ЗАКРЫТА",
        FOXY_ATTACKING = "ФОКСИ АТАКУЕТ! Дверь заблокирована на %.1f сек",
        FOXY_ATTACK_END = "Атака Фокси закончилась - дверь разблокирована",
        SAFE_AREA = "Безопасно - %s ДВЕРЬ ОТКРЫТА",
        INVALID_SPEED = "Неверная скорость! (0-500)",
        INVALID_NORMAL = "Неверная дистанция! (5-100)",
        INVALID_FOXY = "Неверная дистанция Фокси! (10-150)",
        DISTANCE_ERROR = "Закрыть < Открыть!",
        JUMPSCARES_BLOCKED = "%d Скримеров заблокировано!",
        DOOR_CLICK_SUCCESS = "%s дверь %s",
        DOOR_CLICK_FAILED = "Не удалось %s %s дверь",
        
        COORD_DANGER = "%s на опасной позиции!\nТаймер: %.1f/%.1f сек",
        COORD_SAFE = "%s перешел в безопасную зону",
        COORD_DETECTED = "%s обнаружен на опасной точке!\n%s ДВЕРЬ ЗАКРЫТА",
        
        NOTIFICATION = "FNAF 1 Скрипт v1.8.0 загружен!\nТребуется активация ключом\nПерейдите по ссылке для получения ключа",
        
        KEY_TITLE = "FNAF 1 Скрипт v1.8.0 - Требуется активация",
        KEY_INFO = "Для использования скрипта требуется ключ активации.\nКлюч можно получить по ссылке ниже.",
        
        LANGUAGE_CHANGED = "Язык изменен на: %s"
    },
    
    English = {
        ShortName = "ENG",
        TITLE = "FNAF 1 Script v1.8.0",
        ESP_OFF = "ESP: OFF",
        ESP_ON = "ESP: ON",
        FULLBRIGHT_OFF = "Fullbright: OFF",
        FULLBRIGHT_ON = "Fullbright: ON",
        AUTODOOR_OFF = "Auto Door: OFF",
        AUTODOOR_ON = "Auto Door: ON",
        ANTIJUMP_OFF = "Anti-Jumpscare: OFF",
        ANTIJUMP_ON = "Anti-Jumpscare: ON",
        SPEED_HACK = "Speed Hack",
        SPEED_PLACEHOLDER = "Speed...",
        CONFIG_DOORS = "Door Settings",
        READY = "Ready",
        STATUS = "Status",
        BY = "BY:Slippy v1.8.0",
        KEY_REQUIRED = "Key Required",
        KEY_PLACEHOLDER = "Enter key...",
        GET_KEY = "Get Key",
        ACTIVATE = "Activate",
        INVALID_KEY = "Invalid key!",
        ACTIVATION_SUCCESS = "Activation successful!",
        COPY_LINK = "Copy link",
        LINK_COPIED = "Link copied!",
        GET_KEY_INFO = "Click to copy the link to get the key",
        
        CONFIG_TITLE = "Door Configuration",
        NORMAL_CLOSE = "Close door (normal):",
        NORMAL_OPEN = "Open door (normal):",
        FOXY_CLOSE = "Close door (Foxy):",
        FOXY_OPEN = "Open door (Foxy):",
        APPLY = "Apply",
        RESET = "Reset",
        
        ESP_ENABLED = "ESP enabled",
        ESP_DISABLED = "ESP disabled",
        FULLBRIGHT_ENABLED = "Fullbright enabled",
        FULLBRIGHT_DISABLED = "Fullbright disabled",
        AUTODOOR_ENABLED = "Auto Door active\nMonitoring...",
        AUTODOOR_DISABLED = "Auto Door disabled",
        ANTIJUMP_ENABLED = "Anti-Jumpscare enabled",
        ANTIJUMP_DISABLED = "Anti-Jumpscare disabled",
        SPEED_APPLIED = "Speed: %d",
        SPEED_RESET = "Speed reset",
        CONFIG_APPLIED = "Settings applied!",
        CONFIG_RESET = "Settings reset",
        
        NO_GAMETRIGGERS = "GameTriggers not found!",
        NO_JUMPSCARES = "Jumpscares folder not found!",
        DOOR_CLOSED = "%s detected!\n%.0f units - %s DOOR CLOSED",
        FOXY_DETECTED = "%s (FOXY!)\n%.0f units - LEFT DOOR CLOSED",
        FOXY_ATTACKING = "FOXY ATTACKING! Door locked for %.1f sec",
        FOXY_ATTACK_END = "Foxy attack ended - door unlocked",
        SAFE_AREA = "Safe - %s DOOR OPENED",
        INVALID_SPEED = "Invalid speed! (0-500)",
        INVALID_NORMAL = "Invalid distance! (5-100)",
        INVALID_FOXY = "Invalid Foxy distance! (10-150)",
        DISTANCE_ERROR = "Close < Open!",
        JUMPSCARES_BLOCKED = "%d Jumpscares blocked!",
        DOOR_CLICK_SUCCESS = "%s door %s",
        DOOR_CLICK_FAILED = "Failed to %s %s door",
        
        COORD_DANGER = "%s at dangerous position!\nTimer: %.1f/%.1f sec",
        COORD_SAFE = "%s moved to safe zone",
        COORD_DETECTED = "%s detected at dangerous point!\n%s DOOR CLOSED",
        
        NOTIFICATION = "FNAF 1 Script v1.8.0 loaded!\nKey activation required\nFollow the link to get the key",
        
        KEY_TITLE = "FNAF 1 Script v1.8.0 - Activation Required",
        KEY_INFO = "For use of the script, an activation key is required.\nYou can get the key using the link below.",
        
        LANGUAGE_CHANGED = "Language changed to: %s"
    },
    
    German = {
        ShortName = "DEU",
        TITLE = "FNAF 1 Skript v1.8.0",
        ESP_OFF = "ESP: AUS",
        ESP_ON = "ESP: AN",
        FULLBRIGHT_OFF = "Helligkeit: AUS",
        FULLBRIGHT_ON = "Helligkeit: AN",
        AUTODOOR_OFF = "Auto-Tür: AUS",
        AUTODOOR_ON = "Auto-Tür: AN",
        ANTIJUMP_OFF = "Anti-Jumpscare: AUS",
        ANTIJUMP_ON = "Anti-Jumpscare: AN",
        SPEED_HACK = "Geschwindigkeit",
        SPEED_PLACEHOLDER = "Geschwindigkeit...",
        CONFIG_DOORS = "Türeinstellungen",
        READY = "Bereit",
        STATUS = "Status",
        BY = "BY:Slippy v1.8.0",
        KEY_REQUIRED = "Schlüssel benötigt",
        KEY_PLACEHOLDER = "Schlüssel eingeben...",
        GET_KEY = "Schlüssel holen",
        ACTIVATE = "Aktivieren",
        INVALID_KEY = "Ungültiger Schlüssel!",
        ACTIVATION_SUCCESS = "Aktivierung erfolgreich!",
        COPY_LINK = "Link kopieren",
        LINK_COPIED = "Link kopiert!",
        GET_KEY_INFO = "Klicken Sie, um den Link zum Abrufen des Schlüssels zu kopieren",
        
        CONFIG_TITLE = "Türkonfiguration",
        NORMAL_CLOSE = "Tür schließen (normal):",
        NORMAL_OPEN = "Tür öffnen (normal):",
        FOXY_CLOSE = "Tür schließen (Foxy):",
        FOXY_OPEN = "Tür öffnen (Foxy):",
        APPLY = "Anwenden",
        RESET = "Zurücksetzen",
        
        ESP_ENABLED = "ESP aktiviert",
        ESP_DISABLED = "ESP deaktiviert",
        FULLBRIGHT_ENABLED = "Helligkeit aktiviert",
        FULLBRIGHT_DISABLED = "Helligkeit deaktiviert",
        AUTODOOR_ENABLED = "Auto-Tür aktiv\nÜberwache...",
        AUTODOOR_DISABLED = "Auto-Tür deaktiviert",
        ANTIJUMP_ENABLED = "Anti-Jumpscare aktiviert",
        ANTIJUMP_DISABLED = "Anti-Jumpscare deaktiviert",
        SPEED_APPLIED = "Geschwindigkeit: %d",
        SPEED_RESET = "Geschwindigkeit zurückgesetzt",
        CONFIG_APPLIED = "Einstellungen übernommen!",
        CONFIG_RESET = "Einstellungen zurückgesetzt",
        
        NO_GAMETRIGGERS = "GameTriggers nicht gefunden!",
        NO_JUMPSCARES = "Jumpscares-Ordner nicht gefunden!",
        DOOR_CLOSED = "%s erkannt!\n%.0f Einheiten - %s TÜR GESCHLOSSEN",
        FOXY_DETECTED = "%s (FOXY!)\n%.0f Einheiten - LINKE TÜR GESCHLOSSEN",
        FOXY_ATTACKING = "FOXY GREIFT AN! Tür für %.1f Sek gesperrt",
        FOXY_ATTACK_END = "Foxy-Angriff beendet - Tür entsperrt",
        SAFE_AREA = "Sicher - %s TÜR GEÖFFNET",
        INVALID_SPEED = "Ungültige Geschwindigkeit! (0-500)",
        INVALID_NORMAL = "Ungültige Entfernung! (5-100)",
        INVALID_FOXY = "Ungültige Foxy-Entfernung! (10-150)",
        DISTANCE_ERROR = "Schließen < Öffnen!",
        JUMPSCARES_BLOCKED = "%d Jumpscares blockiert!",
        DOOR_CLICK_SUCCESS = "%s Tür %s",
        DOOR_CLICK_FAILED = "Fehler beim %s %s Tür",
        
        COORD_DANGER = "%s an gefährlicher Position!\nTimer: %.1f/%.1f Sek",
        COORD_SAFE = "%s in sichere Zone bewegt",
        COORD_DETECTED = "%s an gefährlichem Punkt erkannt!\n%s TÜR GESCHLOSSEN",
        
        NOTIFICATION = "FNAF 1 Skript v1.8.0 geladen!\nSchlüsselaktivierung erforderlich\nFolgen Sie dem Link, um den Schlüssel zu erhalten",
        
        KEY_TITLE = "FNAF 1 Skript v1.8.0 - Aktivierung erforderlich",
        KEY_INFO = "Für die Verwendung des Skripts wird ein Aktivierungsschlüssel benötigt.\nSie können den Schlüssel über den unten stehenden Link erhalten.",
        
        LANGUAGE_CHANGED = "Sprache geändert zu: %s"
    }
}

-- Список языков для переключения
local languageList = {"English", "Russian", "German"}
local currentLanguageIndex = 1 -- Начинаем с английского
local currentLanguage = Languages[languageList[currentLanguageIndex]]

-- Создание GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FNAF1_ESPGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Key Activation Frame
local KeyFrame = Instance.new("Frame")
KeyFrame.Name = "KeyFrame"
KeyFrame.Size = UDim2.new(0, 350, 0, 250)
KeyFrame.Position = UDim2.new(0.5, -175, 0.5, -125)
KeyFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
KeyFrame.BackgroundTransparency = 0.1
KeyFrame.BorderSizePixel = 0
KeyFrame.Active = true
KeyFrame.Draggable = true
KeyFrame.Parent = ScreenGui

local KeyCorner = Instance.new("UICorner")
KeyCorner.CornerRadius = UDim.new(0, 12)
KeyCorner.Parent = KeyFrame

local KeyStroke = Instance.new("UIStroke")
KeyStroke.Color = Color3.fromRGB(255, 60, 60)
KeyStroke.Transparency = 0.5
KeyStroke.Thickness = 2
KeyStroke.Parent = KeyFrame

-- Key Title
local KeyTitle = Instance.new("TextLabel")
KeyTitle.Name = "KeyTitle"
KeyTitle.Size = UDim2.new(1, 0, 0, 40)
KeyTitle.Position = UDim2.new(0, 0, 0, 10)
KeyTitle.BackgroundTransparency = 1
KeyTitle.Text = currentLanguage.KEY_TITLE
KeyTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
KeyTitle.TextSize = 18
KeyTitle.Font = Enum.Font.GothamBold
KeyTitle.Parent = KeyFrame

-- Key Info
local KeyInfo = Instance.new("TextLabel")
KeyInfo.Name = "KeyInfo"
KeyInfo.Size = UDim2.new(1, -40, 0, 50)
KeyInfo.Position = UDim2.new(0, 20, 0, 50)
KeyInfo.BackgroundTransparency = 1
KeyInfo.Text = currentLanguage.KEY_INFO
KeyInfo.TextColor3 = Color3.fromRGB(200, 200, 200)
KeyInfo.TextSize = 12
KeyInfo.Font = Enum.Font.Gotham
KeyInfo.TextWrapped = true
KeyInfo.TextXAlignment = Enum.TextXAlignment.Center
KeyInfo.Parent = KeyFrame

-- Key Input
local KeyInput = Instance.new("TextBox")
KeyInput.Name = "KeyInput"
KeyInput.Size = UDim2.new(1, -40, 0, 36)
KeyInput.Position = UDim2.new(0, 20, 0, 110)
KeyInput.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
KeyInput.BackgroundTransparency = 0.3
KeyInput.PlaceholderText = currentLanguage.KEY_PLACEHOLDER
KeyInput.Text = ""
KeyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
KeyInput.TextSize = 14
KeyInput.Font = Enum.Font.Gotham
KeyInput.ClearTextOnFocus = false
KeyInput.BorderSizePixel = 0
KeyInput.Parent = KeyFrame

local KeyInputCorner = Instance.new("UICorner")
KeyInputCorner.CornerRadius = UDim.new(0, 8)
KeyInputCorner.Parent = KeyInput

-- Get Key Button
local GetKeyBtn = Instance.new("TextButton")
GetKeyBtn.Name = "GetKeyBtn"
GetKeyBtn.Size = UDim2.new(1, -40, 0, 36)
GetKeyBtn.Position = UDim2.new(0, 20, 0, 155)
GetKeyBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
GetKeyBtn.BackgroundTransparency = 0.3
GetKeyBtn.Text = currentLanguage.GET_KEY
GetKeyBtn.TextColor3 = Color3.fromRGB(150, 200, 255)
GetKeyBtn.TextSize = 13
GetKeyBtn.Font = Enum.Font.GothamSemibold
GetKeyBtn.BorderSizePixel = 0
GetKeyBtn.Parent = KeyFrame

local GetKeyCorner = Instance.new("UICorner")
GetKeyCorner.CornerRadius = UDim.new(0, 8)
GetKeyCorner.Parent = GetKeyBtn

-- Activate Button
local ActivateBtn = Instance.new("TextButton")
ActivateBtn.Name = "ActivateBtn"
ActivateBtn.Size = UDim2.new(1, -40, 0, 36)
ActivateBtn.Position = UDim2.new(0, 20, 0, 200)
ActivateBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
ActivateBtn.BackgroundTransparency = 0.3
ActivateBtn.Text = currentLanguage.ACTIVATE
ActivateBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ActivateBtn.TextSize = 14
ActivateBtn.Font = Enum.Font.GothamBold
ActivateBtn.BorderSizePixel = 0
ActivateBtn.Parent = KeyFrame

local ActivateCorner = Instance.new("UICorner")
ActivateCorner.CornerRadius = UDim.new(0, 8)
ActivateCorner.Parent = ActivateBtn

-- Status Label for Key Frame
local KeyStatusLabel = Instance.new("TextLabel")
KeyStatusLabel.Name = "KeyStatusLabel"
KeyStatusLabel.Size = UDim2.new(1, -40, 0, 20)
KeyStatusLabel.Position = UDim2.new(0, 20, 0, 240)
KeyStatusLabel.BackgroundTransparency = 1
KeyStatusLabel.Text = currentLanguage.KEY_REQUIRED
KeyStatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
KeyStatusLabel.TextSize = 11
KeyStatusLabel.Font = Enum.Font.Gotham
KeyStatusLabel.Parent = KeyFrame

-- Main Frame (скрыт до активации)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 240, 0, 380)
MainFrame.Position = UDim2.new(0.5, -120, 0.5, -190)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
MainFrame.BackgroundTransparency = 0.3
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = false
MainFrame.Parent = ScreenGui
MainFrame.ClipsDescendants = true

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

local MainStroke = Instance.new("UIStroke")
MainStroke.Color = Color3.fromRGB(255, 255, 255)
MainStroke.Transparency = 0.8
MainStroke.Thickness = 1
MainStroke.Parent = MainFrame

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 30)
TitleBar.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
TitleBar.BackgroundTransparency = 0.2
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = TitleBar

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, -120, 1, 0)
Title.Position = UDim2.new(0, 8, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = currentLanguage.TITLE
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 14
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TitleBar

-- Кнопка переключения языка
local LanguageBtn = Instance.new("TextButton")
LanguageBtn.Name = "LanguageBtn"
LanguageBtn.Size = UDim2.new(0, 50, 0, 24)
LanguageBtn.Position = UDim2.new(1, -108, 0, 3)
LanguageBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 60)
LanguageBtn.BackgroundTransparency = 0.3
LanguageBtn.Text = currentLanguage.ShortName
LanguageBtn.TextColor3 = Color3.fromRGB(150, 200, 255)
LanguageBtn.TextSize = 11
LanguageBtn.Font = Enum.Font.GothamBold
LanguageBtn.BorderSizePixel = 0
LanguageBtn.Parent = TitleBar

local LangCorner = Instance.new("UICorner")
LangCorner.CornerRadius = UDim.new(0, 6)
LangCorner.Parent = LanguageBtn

-- Botão Minimizar
local MinimizeBtn = Instance.new("TextButton")
MinimizeBtn.Name = "MinimizeBtn"
MinimizeBtn.Size = UDim2.new(0, 24, 0, 24)
MinimizeBtn.Position = UDim2.new(1, -56, 0, 3)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
MinimizeBtn.BackgroundTransparency = 0.3
MinimizeBtn.Text = "−"
MinimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeBtn.TextSize = 16
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.BorderSizePixel = 0
MinimizeBtn.Parent = TitleBar

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 6)
MinCorner.Parent = MinimizeBtn

-- Botão Fechar
local CloseBtn = Instance.new("TextButton")
CloseBtn.Name = "CloseBtn"
CloseBtn.Size = UDim2.new(0, 24, 0, 24)
CloseBtn.Position = UDim2.new(1, -25, 0, 3)
CloseBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseBtn.BackgroundTransparency = 0.3
CloseBtn.Text = "×"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 18
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.BorderSizePixel = 0
CloseBtn.Parent = TitleBar

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 6)
CloseCorner.Parent = CloseBtn

-- Função para criar botões
local function createButton(name, position, text, parent)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Size = UDim2.new(0, 220, 0, 32)
    btn.Position = position
    btn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
    btn.BackgroundTransparency = 0.3
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 13
    btn.Font = Enum.Font.GothamSemibold
    btn.BorderSizePixel = 0
    btn.Parent = parent
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = btn
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(100, 100, 110)
    stroke.Transparency = 0.7
    stroke.Thickness = 1
    stroke.Parent = btn
    
    return btn, stroke
end

-- Criar botões principais
local ToggleESPBtn, _ = createButton("ToggleESPBtn", UDim2.new(0, 10, 0, 40), currentLanguage.ESP_OFF, MainFrame)
local ToggleFullbrightBtn, _ = createButton("ToggleFullbrightBtn", UDim2.new(0, 10, 0, 78), currentLanguage.FULLBRIGHT_OFF, MainFrame)
local ToggleAutoDoorBtn, _ = createButton("ToggleAutoDoorBtn", UDim2.new(0, 10, 0, 116), currentLanguage.AUTODOOR_OFF, MainFrame)
local ToggleAntiJumpscareBtn, _ = createButton("ToggleAntiJumpscareBtn", UDim2.new(0, 10, 0, 154), currentLanguage.ANTIJUMP_OFF, MainFrame)

-- Speed Frame
local SpeedFrame = Instance.new("Frame")
SpeedFrame.Name = "SpeedFrame"
SpeedFrame.Size = UDim2.new(0, 220, 0, 70)
SpeedFrame.Position = UDim2.new(0, 10, 0, 192)
SpeedFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
SpeedFrame.BackgroundTransparency = 0.3
SpeedFrame.BorderSizePixel = 0
SpeedFrame.Parent = MainFrame

local SpeedCorner = Instance.new("UICorner")
SpeedCorner.CornerRadius = UDim.new(0, 8)
SpeedCorner.Parent = SpeedFrame

local SpeedStroke = Instance.new("UIStroke")
SpeedStroke.Color = Color3.fromRGB(100, 100, 110)
SpeedStroke.Transparency = 0.7
SpeedStroke.Thickness = 1
SpeedStroke.Parent = SpeedFrame

local SpeedLabel = Instance.new("TextLabel")
SpeedLabel.Name = "SpeedLabel"
SpeedLabel.Size = UDim2.new(1, -10, 0, 20)
SpeedLabel.Position = UDim2.new(0, 5, 0, 3)
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.Text = currentLanguage.SPEED_HACK
SpeedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedLabel.TextSize = 12
SpeedLabel.Font = Enum.Font.GothamBold
SpeedLabel.TextXAlignment = Enum.TextXAlignment.Left
SpeedLabel.Parent = SpeedFrame

local SpeedInput = Instance.new("TextBox")
SpeedInput.Name = "SpeedInput"
SpeedInput.Size = UDim2.new(0, 100, 0, 26)
SpeedInput.Position = UDim2.new(0, 5, 0, 25)
SpeedInput.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
SpeedInput.BackgroundTransparency = 0.3
SpeedInput.Text = "16"
SpeedInput.PlaceholderText = currentLanguage.SPEED_PLACEHOLDER
SpeedInput.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedInput.TextSize = 12
SpeedInput.Font = Enum.Font.Gotham
SpeedInput.ClearTextOnFocus = false
SpeedInput.BorderSizePixel = 0
SpeedInput.Parent = SpeedFrame

local InputCorner = Instance.new("UICorner")
InputCorner.CornerRadius = UDim.new(0, 6)
InputCorner.Parent = SpeedInput

local SpeedToggleBtn = Instance.new("TextButton")
SpeedToggleBtn.Name = "SpeedToggleBtn"
SpeedToggleBtn.Size = UDim2.new(0, 108, 0, 26)
SpeedToggleBtn.Position = UDim2.new(0, 107, 0, 25)
SpeedToggleBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
SpeedToggleBtn.BackgroundTransparency = 0.3
SpeedToggleBtn.Text = currentLanguage.APPLY
SpeedToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedToggleBtn.TextSize = 12
SpeedToggleBtn.Font = Enum.Font.GothamSemibold
SpeedToggleBtn.BorderSizePixel = 0
SpeedToggleBtn.Parent = SpeedFrame

local SpeedBtnCorner = Instance.new("UICorner")
SpeedBtnCorner.CornerRadius = UDim.new(0, 6)
SpeedBtnCorner.Parent = SpeedToggleBtn

-- Botão de Configuração
local ConfigBtn, _ = createButton("ConfigBtn", UDim2.new(0, 10, 0, 268), currentLanguage.CONFIG_DOORS, MainFrame)

-- Status Label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Size = UDim2.new(1, -20, 0, 45)
StatusLabel.Position = UDim2.new(0, 10, 0, 306)
StatusLabel.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
StatusLabel.BackgroundTransparency = 0.3
StatusLabel.Text = currentLanguage.READY
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.TextSize = 11
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextWrapped = true
StatusLabel.BorderSizePixel = 0
StatusLabel.Parent = MainFrame

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 8)
StatusCorner.Parent = StatusLabel

-- YT Label
local YTLabel = Instance.new("TextLabel")
YTLabel.Name = "YTLabel"
YTLabel.Size = UDim2.new(1, 0, 0, 18)
YTLabel.Position = UDim2.new(0, 0, 0, 356)
YTLabel.BackgroundTransparency = 1
YTLabel.Text = currentLanguage.BY
YTLabel.TextColor3 = Color3.fromRGB(120, 120, 130)
YTLabel.TextSize = 10
YTLabel.Font = Enum.Font.Gotham
YTLabel.TextXAlignment = Enum.TextXAlignment.Center
YTLabel.Parent = MainFrame

-- CONFIG FRAME
local ConfigFrame = Instance.new("Frame")
ConfigFrame.Name = "ConfigFrame"
ConfigFrame.Size = UDim2.new(0, 280, 0, 340)
ConfigFrame.Position = UDim2.new(0.5, -140, 0.5, -170)
ConfigFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
ConfigFrame.BackgroundTransparency = 0.2
ConfigFrame.BorderSizePixel = 0
ConfigFrame.Active = true
ConfigFrame.Draggable = true
ConfigFrame.Visible = false
ConfigFrame.Parent = ScreenGui

local ConfigCorner = Instance.new("UICorner")
ConfigCorner.CornerRadius = UDim.new(0, 12)
ConfigCorner.Parent = ConfigFrame

local ConfigStroke = Instance.new("UIStroke")
ConfigStroke.Color = Color3.fromRGB(255, 255, 255)
ConfigStroke.Transparency = 0.7
ConfigStroke.Thickness = 2
ConfigStroke.Parent = ConfigFrame

local ConfigTitleBar = Instance.new("Frame")
ConfigTitleBar.Size = UDim2.new(1, 0, 0, 35)
ConfigTitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
ConfigTitleBar.BackgroundTransparency = 0.2
ConfigTitleBar.BorderSizePixel = 0
ConfigTitleBar.Parent = ConfigFrame

local ConfigTitleCorner = Instance.new("UICorner")
ConfigTitleCorner.CornerRadius = UDim.new(0, 12)
ConfigTitleCorner.Parent = ConfigTitleBar

local ConfigTitle = Instance.new("TextLabel")
ConfigTitle.Name = "ConfigTitle"
ConfigTitle.Size = UDim2.new(1, -40, 1, 0)
ConfigTitle.Position = UDim2.new(0, 10, 0, 0)
ConfigTitle.BackgroundTransparency = 1
ConfigTitle.Text = currentLanguage.CONFIG_TITLE
ConfigTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
ConfigTitle.TextSize = 15
ConfigTitle.Font = Enum.Font.GothamBold
ConfigTitle.TextXAlignment = Enum.TextXAlignment.Left
ConfigTitle.Parent = ConfigTitleBar

local CloseConfigBtn = Instance.new("TextButton")
CloseConfigBtn.Name = "CloseConfigBtn"
CloseConfigBtn.Size = UDim2.new(0, 28, 0, 28)
CloseConfigBtn.Position = UDim2.new(1, -32, 0, 3.5)
CloseConfigBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseConfigBtn.BackgroundTransparency = 0.3
CloseConfigBtn.Text = "×"
CloseConfigBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseConfigBtn.TextSize = 20
CloseConfigBtn.Font = Enum.Font.GothamBold
CloseConfigBtn.BorderSizePixel = 0
CloseConfigBtn.Parent = ConfigTitleBar

local CloseConfigCorner = Instance.new("UICorner")
CloseConfigCorner.CornerRadius = UDim.new(0, 6)
CloseConfigCorner.Parent = CloseConfigBtn

-- Função для создания label и input
local function createConfigInput(name, labelText, yPos, defaultValue, parent)
    local label = Instance.new("TextLabel")
    label.Name = name .. "Label"
    label.Size = UDim2.new(1, -20, 0, 18)
    label.Position = UDim2.new(0, 10, 0, yPos)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(220, 220, 220)
    label.TextSize = 12
    label.Font = Enum.Font.GothamSemibold
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = parent
    
    local input = Instance.new("TextBox")
    input.Name = name .. "Input"
    input.Size = UDim2.new(1, -20, 0, 32)
    input.Position = UDim2.new(0, 10, 0, yPos + 20)
    input.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    input.BackgroundTransparency = 0.3
    input.Text = tostring(defaultValue)
    input.PlaceholderText = "Distance..."
    input.TextColor3 = Color3.fromRGB(255, 255, 255)
    input.TextSize = 13
    input.Font = Enum.Font.Gotham
    input.ClearTextOnFocus = false
    input.BorderSizePixel = 0
    input.Parent = parent
    
    local inputCorner = Instance.new("UICorner")
    inputCorner.CornerRadius = UDim.new(0, 8)
    inputCorner.Parent = input
    
    local inputStroke = Instance.new("UIStroke")
    inputStroke.Color = Color3.fromRGB(100, 100, 110)
    inputStroke.Transparency = 0.7
    inputStroke.Thickness = 1
    inputStroke.Parent = input
    
    return label, input
end

-- Criar inputs de configuração
local NormalCloseLabel, NormalCloseInput = createConfigInput("NormalClose", currentLanguage.NORMAL_CLOSE, 45, CLOSE_DISTANCE_NORMAL, ConfigFrame)
local NormalOpenLabel, NormalOpenInput = createConfigInput("NormalOpen", currentLanguage.NORMAL_OPEN, 105, SAFE_DISTANCE_NORMAL, ConfigFrame)
local FoxyCloseLabel, FoxyCloseInput = createConfigInput("FoxyClose", currentLanguage.FOXY_CLOSE, 165, CLOSE_DISTANCE_FOXY, ConfigFrame)
local FoxyOpenLabel, FoxyOpenInput = createConfigInput("FoxyOpen", currentLanguage.FOXY_OPEN, 225, SAFE_DISTANCE_FOXY, ConfigFrame)

local ApplyConfigBtn = Instance.new("TextButton")
ApplyConfigBtn.Name = "ApplyConfigBtn"
ApplyConfigBtn.Size = UDim2.new(0, 125, 0, 35)
ApplyConfigBtn.Position = UDim2.new(0, 10, 0, 290)
ApplyConfigBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
ApplyConfigBtn.BackgroundTransparency = 0.3
ApplyConfigBtn.Text = currentLanguage.APPLY
ApplyConfigBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ApplyConfigBtn.TextSize = 14
ApplyConfigBtn.Font = Enum.Font.GothamBold
ApplyConfigBtn.BorderSizePixel = 0
ApplyConfigBtn.Parent = ConfigFrame

local ApplyConfigCorner = Instance.new("UICorner")
ApplyConfigCorner.CornerRadius = UDim.new(0, 8)
ApplyConfigCorner.Parent = ApplyConfigBtn

local ResetConfigBtn = Instance.new("TextButton")
ResetConfigBtn.Name = "ResetConfigBtn"
ResetConfigBtn.Size = UDim2.new(0, 125, 0, 35)
ResetConfigBtn.Position = UDim2.new(0, 145, 0, 290)
ResetConfigBtn.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
ResetConfigBtn.BackgroundTransparency = 0.3
ResetConfigBtn.Text = currentLanguage.RESET
ResetConfigBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ResetConfigBtn.TextSize = 14
ResetConfigBtn.Font = Enum.Font.GothamBold
ResetConfigBtn.BorderSizePixel = 0
ResetConfigBtn.Parent = ConfigFrame

local ResetConfigCorner = Instance.new("UICorner")
ResetConfigCorner.CornerRadius = UDim.new(0, 8)
ResetConfigCorner.Parent = ResetConfigBtn

-- Функция обновления ВСЕХ текстов в интерфейсе
local function updateAllTexts()
    -- Обновляем начальное окно (KeyFrame)
    KeyTitle.Text = currentLanguage.KEY_TITLE
    KeyInfo.Text = currentLanguage.KEY_INFO
    KeyInput.PlaceholderText = currentLanguage.KEY_PLACEHOLDER
    GetKeyBtn.Text = currentLanguage.GET_KEY
    ActivateBtn.Text = currentLanguage.ACTIVATE
    KeyStatusLabel.Text = currentLanguage.KEY_REQUIRED
    
    -- Если скрипт активирован, обновляем основное меню
    if scriptActivated then
        -- Основное меню
        Title.Text = currentLanguage.TITLE
        ToggleESPBtn.Text = espEnabled and currentLanguage.ESP_ON or currentLanguage.ESP_OFF
        ToggleFullbrightBtn.Text = fullbrightEnabled and currentLanguage.FULLBRIGHT_ON or currentLanguage.FULLBRIGHT_OFF
        ToggleAutoDoorBtn.Text = autoDoorEnabled and currentLanguage.AUTODOOR_ON or currentLanguage.AUTODOOR_OFF
        ToggleAntiJumpscareBtn.Text = antiJumpscareEnabled and currentLanguage.ANTIJUMP_ON or currentLanguage.ANTIJUMP_OFF
        SpeedLabel.Text = currentLanguage.SPEED_HACK
        SpeedInput.PlaceholderText = currentLanguage.SPEED_PLACEHOLDER
        SpeedToggleBtn.Text = currentLanguage.APPLY
        ConfigBtn.Text = currentLanguage.CONFIG_DOORS
        StatusLabel.Text = currentLanguage.READY
        YTLabel.Text = currentLanguage.BY
        
        -- Кнопка языка
        LanguageBtn.Text = currentLanguage.ShortName
        
        -- Окно конфигурации
        ConfigTitle.Text = currentLanguage.CONFIG_TITLE
        NormalCloseLabel.Text = currentLanguage.NORMAL_CLOSE
        NormalOpenLabel.Text = currentLanguage.NORMAL_OPEN
        FoxyCloseLabel.Text = currentLanguage.FOXY_CLOSE
        FoxyOpenLabel.Text = currentLanguage.FOXY_OPEN
        ApplyConfigBtn.Text = currentLanguage.APPLY
        ResetConfigBtn.Text = currentLanguage.RESET
    end
end

-- Функция переключения языка
local function switchLanguage()
    currentLanguageIndex = currentLanguageIndex + 1
    if currentLanguageIndex > #languageList then
        currentLanguageIndex = 1
    end
    
    -- Обновляем текущий язык
    currentLanguage = Languages[languageList[currentLanguageIndex]]
    
    -- Обновляем ВСЕ тексты в интерфейсе
    updateAllTexts()
    
    -- Анимация кнопки языка
    TweenService:Create(LanguageBtn, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(60, 60, 120)
    }):Play()
    
    task.wait(0.2)
    
    TweenService:Create(LanguageBtn, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(30, 30, 60)
    }):Play()
    
    -- Показываем уведомление о смене языка
    if scriptActivated then
        StatusLabel.Text = string.format(currentLanguage.LANGUAGE_CHANGED, currentLanguage.ShortName)
        StatusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
    end
end

-- Функция активации скрипта
local function activateScript()
    local inputKey = KeyInput.Text
    
    if inputKey == REQUIRED_KEY then
        scriptActivated = true
        
        -- Анимация успешной активации
        TweenService:Create(KeyFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0.7,
            Position = UDim2.new(0.5, -175, 0, -300)
        }):Play()
        
        TweenService:Create(KeyStroke, TweenInfo.new(0.5), {
            Transparency = 1
        }):Play()
        
        KeyStatusLabel.Text = currentLanguage.ACTIVATION_SUCCESS
        KeyStatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        task.wait(0.7)
        
        -- Показываем основной интерфейс
        KeyFrame.Visible = false
        MainFrame.Visible = true
        
        -- Уведомление об успешной активации
        local notification = Instance.new("Frame")
        notification.Size = UDim2.new(0, 250, 0, 60)
        notification.Position = UDim2.new(0.5, -125, 0, 20)
        notification.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
        notification.BackgroundTransparency = 0.2
        notification.BorderSizePixel = 0
        notification.Parent = ScreenGui
        
        local nCorner = Instance.new("UICorner")
        nCorner.CornerRadius = UDim.new(0, 10)
        nCorner.Parent = notification
        
        local nStroke = Instance.new("UIStroke")
        nStroke.Color = Color3.fromRGB(100, 255, 100)
        nStroke.Transparency = 0.5
        nStroke.Thickness = 2
        nStroke.Parent = notification
        
        local nLabel = Instance.new("TextLabel")
        nLabel.Size = UDim2.new(1, -10, 1, -10)
        nLabel.Position = UDim2.new(0, 5, 0, 5)
        nLabel.BackgroundTransparency = 1
        nLabel.Text = currentLanguage.NOTIFICATION
        nLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        nLabel.TextSize = 13
        nLabel.Font = Enum.Font.GothamSemibold
        nLabel.TextWrapped = true
        nLabel.Parent = notification
        
        task.wait(3)
        
        local fadeOut = TweenService:Create(notification, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
            Position = UDim2.new(0.5, -125, 0, -70),
            BackgroundTransparency = 1
        })
        fadeOut:Play()
        
        TweenService:Create(nLabel, TweenInfo.new(0.3), {TextTransparency = 1}):Play()
        TweenService:Create(nStroke, TweenInfo.new(0.3), {Transparency = 1}):Play()
        
        fadeOut.Completed:Connect(function()
            notification:Destroy()
        end)
        
        -- Обновляем все тексты
        updateAllTexts()
        
        -- Подключаем кнопки
        setupButtonsAfterActivation()
        
        return true
    else
        -- Неверный ключ
        KeyStatusLabel.Text = currentLanguage.INVALID_KEY
        KeyStatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        
        -- Анимация ошибки
        TweenService:Create(KeyInput, TweenInfo.new(0.1, Enum.EasingStyle.Back, Enum.EasingDirection.Out, 3, true), {
            Position = UDim2.new(0, 15, 0, 110)
        }):Play()
        
        TweenService:Create(KeyInput, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        }):Play()
        
        task.wait(0.1)
        
        TweenService:Create(KeyInput, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(25, 25, 30)
        }):Play()
        
        return false
    end
end

-- Кнопка получения ключа
GetKeyBtn.MouseButton1Click:Connect(function()
    -- Вставляем ссылку в поле для ключа
    KeyInput.Text = KEY_LINK
    KeyInput.TextColor3 = Color3.fromRGB(100, 200, 255)
    
    -- Фокус на поле для удобного копирования
    KeyInput:CaptureFocus()
    
    -- Выделяем весь текст для удобного копирования
    task.wait(0.1)
    KeyInput.SelectionStart = 1
    KeyInput.CursorPosition = string.len(KEY_LINK) + 1
    
    -- Показываем инструкцию в статусе
    KeyStatusLabel.Text = currentLanguage.GET_KEY_INFO
    KeyStatusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
    
    -- Анимация подсветки поля
    TweenService:Create(KeyInput, TweenInfo.new(0.3), {
        BackgroundColor3 = Color3.fromRGB(30, 30, 60)
    }):Play()
    
    -- Восстанавливаем нормальное состояние через несколько секунд
    task.wait(5)
    
    TweenService:Create(KeyInput, TweenInfo.new(0.3), {
        BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    }):Play()
    
    -- Скрываем инструкцию
    task.wait(2)
    KeyStatusLabel.Text = currentLanguage.KEY_REQUIRED
    KeyStatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
end)

-- Кнопка активации
ActivateBtn.MouseButton1Click:Connect(activateScript)

-- Автоматическая активация при нажатии Enter
KeyInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        activateScript()
    end
end)

-- Animação estilo iPhone
local function animateButtoniPhone(button, activated)
    if not scriptActivated then return end
    local originalBg = Color3.fromRGB(40, 40, 45)
    local activeBg = Color3.fromRGB(255, 60, 60)
    
    if activated then
        local tween1 = TweenService:Create(button, TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundColor3 = activeBg,
            BackgroundTransparency = 0.4
        })
        tween1:Play()
        
        tween1.Completed:Connect(function()
            local pulse = TweenService:Create(button, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1), {
                BackgroundTransparency = 0.5
            })
            pulse:Play()
            activeTweens[button] = pulse
        end)
    else
        local pulse = activeTweens[button]
        if pulse then
            pulse:Cancel()
            activeTweens[button] = nil
        end
        
        local tween2 = TweenService:Create(button, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            BackgroundColor3 = originalBg,
            BackgroundTransparency = 0.3
        })
        tween2:Play()
    end
end

-- Функция проверки позиции
local function isPositionNear(targetPos, checkPos, threshold)
    if not targetPos or not checkPos then return false end
    return math.abs(targetPos.X - checkPos.X) <= threshold and
           math.abs(targetPos.Y - checkPos.Y) <= threshold and
           math.abs(targetPos.Z - checkPos.Z) <= threshold
end

-- Функция проверки безопасной позиции
local function isSafePosition(animName, position)
    local animData = animatronicPositions[animName]
    if not animData then return false end
    
    for _, safePos in ipairs(animData.safePositions) do
        if isPositionNear(safePos, position, detectionThreshold) then
            return true
        end
    end
    return false
end

-- Функция проверки опасной позиции
local function isDangerPosition(animName, position)
    local animData = animatronicPositions[animName]
    if not animData then return false end
    
    for _, dangerPos in ipairs(animData.dangerPositions) do
        if isPositionNear(dangerPos, position, detectionThreshold) then
            return true
        end
    end
    return false
end

-- Функция для получения позиции аниматроника
local function getAnimatronicPosition(animName)
    local animFolder = Workspace:FindFirstChild("Animatronics")
    if not animFolder then return nil end
    
    local animObj = animFolder:FindFirstChild(animName)
    if not animObj then return nil end
    
    local targets = {"NPC", "Model", "Part", "HumanoidRootPart", "Torso"}
    
    for _, target in ipairs(targets) do
        local targetObj = animObj:FindFirstChild(target)
        if not targetObj then
            local waypoints = animObj:FindFirstChild("Waypoints")
            if waypoints then
                targetObj = waypoints:FindFirstChild(target)
            end
        end
        
        if not targetObj then
            for _, child in ipairs(animObj:GetDescendants()) do
                if child.Name == target then
                    targetObj = child
                    break
                end
            end
        end
        
        if targetObj then
            local position
            pcall(function()
                if targetObj:IsA("Model") then
                    local primaryPart = targetObj.PrimaryPart or targetObj:FindFirstChild("HumanoidRootPart") or 
                                        targetObj:FindFirstChild("Torso") or targetObj:FindFirstChildWhichIsA("BasePart")
                    if primaryPart then
                        position = primaryPart.Position
                    end
                elseif targetObj:IsA("BasePart") then
                    position = targetObj.Position
                end
            end)
            
            if position then
                return Vector3.new(
                    math.floor(position.X * 10) / 10,
                    math.floor(position.Y * 10) / 10,
                    math.floor(position.Z * 10) / 10
                )
            end
        end
    end
    
    return nil
end

-- Funções Anti-Jumpscare
local function disableJumpscares()
    if not scriptActivated then return end
    local jumpscareFolder = Workspace:FindFirstChild("GameTriggers")
    if not jumpscareFolder then
        StatusLabel.Text = currentLanguage.NO_GAMETRIGGERS
        return
    end
    
    local jumpscares = jumpscareFolder:FindFirstChild("Jumpscares")
    if not jumpscares then
        StatusLabel.Text = currentLanguage.NO_JUMPSCARES
        return
    end
    
    local disabledCount = 0
    
    for _, animName in ipairs(animatronicsWithJumpscares) do
        local animJumpscare = jumpscares:FindFirstChild(animName)
        if animJumpscare then
            table.insert(jumpscareObjects, animJumpscare)
            
            for _, obj in ipairs(animJumpscare:GetDescendants()) do
                if obj:IsA("BasePart") then
                    obj.CanCollide = false
                    obj.CanTouch = false
                    obj.Transparency = 1
                end
            end
            
            local anchorPart = animJumpscare:FindFirstChild("AnchorPart")
            if anchorPart and anchorPart:IsA("BasePart") then
                anchorPart.CFrame = CFrame.new(0, -10000, 0)
            end
            
            disabledCount = disabledCount + 1
        end
    end
    
    StatusLabel.Text = string.format(currentLanguage.JUMPSCARES_BLOCKED, disabledCount)
    StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
end

local function enableJumpscares()
    if not scriptActivated then return end
    local jumpscareFolder = Workspace:FindFirstChild("GameTriggers")
    if not jumpscareFolder then return end
    
    local jumpscares = jumpscareFolder:FindFirstChild("Jumpscares")
    if not jumpscares then return end
    
    for _, animName in ipairs(animatronicsWithJumpscares) do
        local animJumpscare = jumpscares:FindFirstChild(animName)
        if animJumpscare then
            for _, obj in ipairs(animJumpscare:GetDescendants()) do
                if obj:IsA("BasePart") then
                    obj.CanCollide = true
                    obj.CanTouch = true
                    obj.Transparency = 0
                end
            end
        end
    end
    
    StatusLabel.Text = currentLanguage.ANTIJUMP_DISABLED
    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
end

-- Funções ESP
local function createHighlight(obj, name)
    if not scriptActivated then return end
    if highlights[obj] then return end
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESP_" .. name
    highlight.Adornee = obj
    highlight.FillColor = Color3.fromRGB(255, 0, 0)
    highlight.FillTransparency = 0.5
    highlight.OutlineColor = Color3.fromRGB(255, 0, 0)
    highlight.OutlineTransparency = 0
    highlight.Parent = obj
    
    highlights[obj] = highlight
end

local function removeHighlight(obj)
    if not scriptActivated then return end
    if highlights[obj] then
        highlights[obj]:Destroy()
        highlights[obj] = nil
    end
end

-- Улучшенная система дверей с точной телепортацией
local function clickDoor(doorSide, shouldClose)
    if not scriptActivated then return false end
    local currentTime = tick()
    
    if doorCooldowns[doorSide] > currentTime then
        return false
    end
    
    if doorStates[doorSide] == shouldClose then
        return false
    end
    
    local success, result = pcall(function()
        local character = LocalPlayer.Character
        if not character then return false end
        
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if not humanoidRootPart then return false end
        
        local camera = Workspace.CurrentCamera
        if not camera then return false end
        
        local originalPosition = humanoidRootPart.CFrame
        local originalCamera = camera.CFrame
        local originalFOV = camera.FieldOfView
        
        local coords = DOOR_COORDINATES[doorSide]
        if not coords then return false end
        
        -- Телепортируемся на точную позицию
        humanoidRootPart.CFrame = CFrame.new(coords.playerPos)
        
        task.wait(0.1)
        
        -- Поворачиваем камеру в нужном направлении
        local cameraCFrame = CFrame.new(coords.cameraPos) * CFrame.Angles(0, coords.yawRadians, 0)
        camera.CFrame = cameraCFrame
        camera.FieldOfView = 70
        
        task.wait(0.2)
        
        -- Ищем кнопку или дверь
        local officeButtons = Workspace.GameTriggers and Workspace.GameTriggers.OfficeButtons
        local successClicked = false
        
        if officeButtons then
            -- Пробуем сначала кнопку
            local buttonName = doorSide .. "DoorButton"
            local doorButton = officeButtons:FindFirstChild(buttonName)
            
            if doorButton then
                for _, descendant in pairs(doorButton:GetDescendants()) do
                    if descendant:IsA("ClickDetector") then
                        fireclickdetector(descendant)
                        successClicked = true
                        break
                    elseif descendant:IsA("ProximityPrompt") then
                        descendant.HoldDuration = 0
                        descendant.MaxActivationDistance = 100
                        fireproximityprompt(descendant)
                        successClicked = true
                        break
                    end
                end
            end
            
            -- Пробуем саму дверь
            if not successClicked then
                local doorName = doorSide .. "Door"
                local door = officeButtons:FindFirstChild(doorName)
                
                if door then
                    for _, descendant in pairs(door:GetDescendants()) do
                        if descendant:IsA("ClickDetector") then
                            fireclickdetector(descendant)
                            successClicked = true
                            break
                        elseif descendant:IsA("ProximityPrompt") then
                            descendant.HoldDuration = 0
                            descendant.MaxActivationDistance = 100
                            fireproximityprompt(descendant)
                            successClicked = true
                            break
                        end
                    end
                end
            end
        end
        
        -- RemoteEvent как запасной вариант
        if not successClicked and ReplicatedStorage:FindFirstChild("RemoteEvents") then
            local remoteEvent = ReplicatedStorage.RemoteEvents:FindFirstChild("playerUsedClickOnObjectEvent")
            if remoteEvent and officeButtons then
                local targetObject = officeButtons:FindFirstChild(doorSide .. "DoorButton") or 
                                    officeButtons:FindFirstChild(doorSide .. "Door")
                if targetObject then
                    remoteEvent:FireServer(targetObject)
                    successClicked = true
                end
            end
        end
        
        if successClicked then
            doorCooldowns[doorSide] = currentTime + 1.5
            doorStates[doorSide] = shouldClose
            
            local actionText = shouldClose and "closed" or "opened"
            StatusLabel.Text = string.format(currentLanguage.DOOR_CLICK_SUCCESS, doorSide, actionText)
            StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        else
            StatusLabel.Text = string.format(currentLanguage.DOOR_CLICK_FAILED, 
                shouldClose and "close" or "open", doorSide)
            StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
        
        -- Возвращаемся
        task.wait(0.3)
        humanoidRootPart.CFrame = originalPosition
        camera.CFrame = originalCamera
        camera.FieldOfView = originalFOV
        
        return successClicked
        
    end)
    
    if not success then
        pcall(function()
            local character = LocalPlayer.Character
            if character then
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                if humanoidRootPart then
                    humanoidRootPart.CFrame = CFrame.new(0, 5, 0)
                end
            end
        end)
    end
    
    return success and result
end

-- Проверка аниматроников по координатам
local function checkAnimatronicsByCoordinates()
    if not scriptActivated or not autoDoorEnabled then return end
    
    local currentTime = tick()
    local threatsLeft = {}
    local threatsRight = {}
    
    for _, animName in ipairs({"Chica", "Bonnie", "Freddy"}) do
        local position = getAnimatronicPosition(animName)
        
        if position then
            local side = (animName == "Bonnie") and "Left" or "Right"
            
            if isSafePosition(animName, position) then
                if detectionTimers[animName].dangerTimer > 0 then
                    detectionTimers[animName].dangerTimer = 0
                    StatusLabel.Text = string.format(currentLanguage.COORD_SAFE, animName)
                    StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
                end
                detectionTimers[animName].lastPosition = position
            elseif isDangerPosition(animName, position) then
                if detectionTimers[animName].lastPosition and 
                   not isPositionNear(detectionTimers[animName].lastPosition, position, 0.5) then
                    detectionTimers[animName].dangerTimer = currentTime
                    detectionTimers[animName].lastPosition = position
                elseif detectionTimers[animName].dangerTimer == 0 then
                    detectionTimers[animName].dangerTimer = currentTime
                    detectionTimers[animName].lastPosition = position
                end
                
                local timeOnSpot = currentTime - detectionTimers[animName].dangerTimer
                
                if timeOnSpot >= detectionTime then
                    table.insert((side == "Left") and threatsLeft or threatsRight, {
                        name = animName,
                        distance = 0,
                        isFoxy = false,
                        isCoordinateDetected = true,
                        timeOnSpot = timeOnSpot
                    })
                    
                    StatusLabel.Text = string.format(currentLanguage.COORD_DETECTED, animName, 
                        (side == "Left") and "LEFT" or "RIGHT")
                    StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
                else
                    StatusLabel.Text = string.format(currentLanguage.COORD_DANGER, animName, 
                        timeOnSpot, detectionTime)
                    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
                end
            else
                detectionTimers[animName].dangerTimer = 0
                detectionTimers[animName].lastPosition = position
            end
        else
            detectionTimers[animName].dangerTimer = 0
            detectionTimers[animName].lastPosition = nil
        end
    end
    
    -- Обработка угроз слева (Bonnie)
    if #threatsLeft > 0 and not doorStates.Left then
        clickDoor("Left", true)
    elseif #threatsLeft == 0 and doorStates.Left and not foxyAttackActive then
        clickDoor("Left", false)
        StatusLabel.Text = string.format(currentLanguage.SAFE_AREA, "LEFT")
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
    end
    
    -- Обработка угроз справа (Chica, Freddy)
    if #threatsRight > 0 and not doorStates.Right then
        clickDoor("Right", true)
    elseif #threatsRight == 0 and doorStates.Right then
        clickDoor("Right", false)
        StatusLabel.Text = string.format(currentLanguage.SAFE_AREA, "RIGHT")
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
    end
end

-- Функция для Фокси
local function checkAnimatronicsDistance()
    if not scriptActivated or not autoDoorEnabled then return end
    
    local currentTime = tick()
    local character = LocalPlayer.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    local playerPosition = humanoidRootPart.Position
    local foxyDetected = false
    local minFoxyDistance = math.huge
    
    for _, anim in ipairs(animatronics) do
        if anim.isFoxy and anim.side == "Left" then
            local success, obj = pcall(function()
                local animFolder = Workspace:FindFirstChild("Animatronics")
                if not animFolder then return nil end
                
                local animObj = animFolder:FindFirstChild(anim.name)
                if not animObj then return nil end
                
                local targetObj = animObj:FindFirstChild(anim.target)
                
                if not targetObj then
                    local waypoints = animObj:FindFirstChild("Waypoints")
                    if waypoints then
                        targetObj = waypoints:FindFirstChild(anim.target)
                    end
                end
                
                if not targetObj then
                    for _, child in ipairs(animObj:GetDescendants()) do
                        if child.Name == anim.target then
                            targetObj = child
                            break
                        end
                    end
                end
                
                return targetObj
            end)
            
            if success and obj then
                local animPosition
                pcall(function()
                    if obj:IsA("Model") then
                        local primaryPart = obj.PrimaryPart or obj:FindFirstChild("HumanoidRootPart") or 
                                            obj:FindFirstChild("Torso") or obj:FindFirstChildWhichIsA("BasePart")
                        if primaryPart then
                            animPosition = primaryPart.Position
                        end
                    elseif obj:IsA("BasePart") then
                        animPosition = obj.Position
                    end
                end)
                
                if animPosition then
                    local distance = (playerPosition - animPosition).Magnitude
                    foxyDetected = true
                    if distance < minFoxyDistance then
                        minFoxyDistance = distance
                    end
                end
            end
        end
    end
    
    if foxyAttackActive then
        local timeSinceAttack = currentTime - foxyAttackStartTime
        if timeSinceAttack >= FOXY_ATTACK_DURATION then
            foxyAttackActive = false
            StatusLabel.Text = currentLanguage.FOXY_ATTACK_END
            StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        else
            local timeLeft = FOXY_ATTACK_DURATION - timeSinceAttack
            StatusLabel.Text = string.format(currentLanguage.FOXY_ATTACKING, timeLeft)
            StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 100)
            
            if not doorStates.Left then
                clickDoor("Left", true)
            end
            return
        end
    end
    
    if foxyDetected then
        foxyLastDistance = minFoxyDistance
        
        if minFoxyDistance <= CLOSE_DISTANCE_FOXY then
            foxyAttackActive = true
            foxyAttackStartTime = currentTime
            
            if not doorStates.Left then
                clickDoor("Left", true)
            end
            
            StatusLabel.Text = string.format(currentLanguage.FOXY_DETECTED, "Foxy", minFoxyDistance)
            StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
        elseif minFoxyDistance > SAFE_DISTANCE_FOXY and doorStates.Left then
            clickDoor("Left", false)
            StatusLabel.Text = string.format(currentLanguage.SAFE_AREA, "LEFT")
            StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
        end
    else
        if doorStates.Left and not foxyAttackActive then
            clickDoor("Left", false)
            StatusLabel.Text = string.format(currentLanguage.SAFE_AREA, "LEFT")
            StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
        end
    end
end

-- Основной цикл проверки
local function runAutoDoorCheck()
    if not scriptActivated then return end
    
    checkAnimatronicsByCoordinates()
    checkAnimatronicsDistance()
end

-- Toggle Functions с проверкой активации
local function toggleESP()
    if not scriptActivated then 
        StatusLabel.Text = "Activation required!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return 
    end
    
    espEnabled = not espEnabled
    animateButtoniPhone(ToggleESPBtn, espEnabled)
    ToggleESPBtn.Text = espEnabled and currentLanguage.ESP_ON or currentLanguage.ESP_OFF
    StatusLabel.Text = espEnabled and currentLanguage.ESP_ENABLED or currentLanguage.ESP_DISABLED
    StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    
    if espEnabled then
        for _, anim in ipairs(animatronics) do
            local success, obj = pcall(function()
                local animFolder = Workspace:FindFirstChild("Animatronics")
                if not animFolder then return nil end
                
                local animObj = animFolder:FindFirstChild(anim.name)
                if not animObj then return nil end
                
                local targetObj = animObj:FindFirstChild(anim.target)
                
                if not targetObj then
                    local waypoints = animObj:FindFirstChild("Waypoints")
                    if waypoints then
                        targetObj = waypoints:FindFirstChild(anim.target)
                    end
                end
                
                if not targetObj then
                    for _, child in ipairs(animObj:GetDescendants()) do
                        if child.Name == anim.target then
                            targetObj = child
                            break
                        end
                    end
                end
                
                return targetObj
            end)
            
            if success and obj then
                createHighlight(obj, anim.name)
            end
        end
    else
        for obj, _ in pairs(highlights) do
            removeHighlight(obj)
        end
    end
end

local function toggleFullbright()
    if not scriptActivated then 
        StatusLabel.Text = "Activation required!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return 
    end
    
    fullbrightEnabled = not fullbrightEnabled
    animateButtoniPhone(ToggleFullbrightBtn, fullbrightEnabled)
    ToggleFullbrightBtn.Text = fullbrightEnabled and currentLanguage.FULLBRIGHT_ON or currentLanguage.FULLBRIGHT_OFF
    StatusLabel.Text = fullbrightEnabled and currentLanguage.FULLBRIGHT_ENABLED or currentLanguage.FULLBRIGHT_DISABLED
    StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    
    if fullbrightEnabled then
        originalLighting.Ambient = Lighting.Ambient
        originalLighting.Brightness = Lighting.Brightness
        originalLighting.ColorShift_Bottom = Lighting.ColorShift_Bottom
        originalLighting.ColorShift_Top = Lighting.ColorShift_Top
        originalLighting.OutdoorAmbient = Lighting.OutdoorAmbient
        originalLighting.ClockTime = Lighting.ClockTime
        originalLighting.FogEnd = Lighting.FogEnd
        originalLighting.GlobalShadows = Lighting.GlobalShadows
        
        Lighting.Ambient = Color3.fromRGB(255, 255, 255)
        Lighting.Brightness = 2
        Lighting.ColorShift_Bottom = Color3.fromRGB(255, 255, 255)
        Lighting.ColorShift_Top = Color3.fromRGB(255, 255, 255)
        Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
    else
        Lighting.Ambient = originalLighting.Ambient
        Lighting.Brightness = originalLighting.Brightness
        Lighting.ColorShift_Bottom = originalLighting.ColorShift_Bottom
        Lighting.ColorShift_Top = originalLighting.ColorShift_Top
        Lighting.OutdoorAmbient = originalLighting.OutdoorAmbient
        Lighting.ClockTime = originalLighting.ClockTime
        Lighting.FogEnd = originalLighting.FogEnd
        Lighting.GlobalShadows = originalLighting.GlobalShadows
    end
end

local function toggleAutoDoor()
    if not scriptActivated then 
        StatusLabel.Text = "Activation required!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return 
    end
    
    autoDoorEnabled = not autoDoorEnabled
    animateButtoniPhone(ToggleAutoDoorBtn, autoDoorEnabled)
    ToggleAutoDoorBtn.Text = autoDoorEnabled and currentLanguage.AUTODOOR_ON or currentLanguage.AUTODOOR_OFF
    StatusLabel.Text = autoDoorEnabled and currentLanguage.AUTODOOR_ENABLED or currentLanguage.AUTODOOR_DISABLED
    StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
end

local function toggleAntiJumpscare()
    if not scriptActivated then 
        StatusLabel.Text = "Activation required!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return 
    end
    
    antiJumpscareEnabled = not antiJumpscareEnabled
    animateButtoniPhone(ToggleAntiJumpscareBtn, antiJumpscareEnabled)
    ToggleAntiJumpscareBtn.Text = antiJumpscareEnabled and currentLanguage.ANTIJUMP_ON or currentLanguage.ANTIJUMP_OFF
    
    if antiJumpscareEnabled then
        disableJumpscares()
    else
        enableJumpscares()
        StatusLabel.Text = currentLanguage.ANTIJUMP_DISABLED
        StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    end
end

local function applySpeed()
    if not scriptActivated then 
        StatusLabel.Text = "Activation required!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return 
    end
    
    local inputSpeed = tonumber(SpeedInput.Text)
    if not inputSpeed or inputSpeed < 0 or inputSpeed > 500 then
        StatusLabel.Text = currentLanguage.INVALID_SPEED
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    speedHackEnabled = inputSpeed ~= originalSpeed
    currentSpeed = inputSpeed
    
    local character = LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = currentSpeed
        end
    end
    
    animateButtoniPhone(SpeedToggleBtn, speedHackEnabled)
    SpeedToggleBtn.Text = speedHackEnabled and currentLanguage.RESET or currentLanguage.APPLY
    StatusLabel.Text = string.format(currentLanguage.SPEED_APPLIED, currentSpeed)
    StatusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
end

local function resetSpeed()
    if not scriptActivated then return end
    
    SpeedInput.Text = tostring(originalSpeed)
    speedHackEnabled = false
    currentSpeed = originalSpeed
    
    local character = LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = originalSpeed
        end
    end
    
    animateButtoniPhone(SpeedToggleBtn, false)
    SpeedToggleBtn.Text = currentLanguage.APPLY
    StatusLabel.Text = currentLanguage.SPEED_RESET
    StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
end

-- Funções de Configuração
local function applyConfig()
    if not scriptActivated then 
        StatusLabel.Text = "Activation required!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        ConfigFrame.Visible = false
        return 
    end
    
    local normalClose = tonumber(NormalCloseInput.Text)
    local normalOpen = tonumber(NormalOpenInput.Text)
    local foxyClose = tonumber(FoxyCloseInput.Text)
    local foxyOpen = tonumber(FoxyOpenInput.Text)
    
    if not normalClose or normalClose < 5 or normalClose > 100 then
        StatusLabel.Text = currentLanguage.INVALID_NORMAL
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if not normalOpen or normalOpen < 5 or normalOpen > 100 then
        StatusLabel.Text = currentLanguage.INVALID_NORMAL
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if not foxyClose or foxyClose < 10 or foxyClose > 150 then
        StatusLabel.Text = currentLanguage.INVALID_FOXY
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if not foxyOpen or foxyOpen < 10 or foxyOpen > 150 then
        StatusLabel.Text = currentLanguage.INVALID_FOXY
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if normalClose >= normalOpen then
        StatusLabel.Text = currentLanguage.DISTANCE_ERROR
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if foxyClose >= foxyOpen then
        StatusLabel.Text = currentLanguage.DISTANCE_ERROR
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    CLOSE_DISTANCE_NORMAL = normalClose
    SAFE_DISTANCE_NORMAL = normalOpen
    CLOSE_DISTANCE_FOXY = foxyClose
    SAFE_DISTANCE_FOXY = foxyOpen
    
    StatusLabel.Text = currentLanguage.CONFIG_APPLIED
    StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
    
    ConfigFrame.Visible = false
end

local function resetConfig()
    if not scriptActivated then return end
    
    CLOSE_DISTANCE_NORMAL = 16
    SAFE_DISTANCE_NORMAL = 18
    CLOSE_DISTANCE_FOXY = 40
    SAFE_DISTANCE_FOXY = 70
    
    NormalCloseInput.Text = "16"
    NormalOpenInput.Text = "18"
    FoxyCloseInput.Text = "40"
    FoxyOpenInput.Text = "70"
    
    StatusLabel.Text = currentLanguage.CONFIG_RESET
    StatusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
end

-- Добавляем эффекты наведения для кнопок активации
local function addHoverEffectToActivationButtons()
    if not UserInputService.TouchEnabled then
        GetKeyBtn.MouseEnter:Connect(function()
            TweenService:Create(GetKeyBtn, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0.1
            }):Play()
        end)
        
        GetKeyBtn.MouseLeave:Connect(function()
            TweenService:Create(GetKeyBtn, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0.3
            }):Play()
        end)
        
        ActivateBtn.MouseEnter:Connect(function()
            TweenService:Create(ActivateBtn, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0.1
            }):Play()
        end)
        
        ActivateBtn.MouseLeave:Connect(function()
            TweenService:Create(ActivateBtn, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0.3
            }):Play()
        end)
    end
end

-- Вызываем сразу для кнопок активации
addHoverEffectToActivationButtons()

-- Manter velocidade ao respawnar
LocalPlayer.CharacterAdded:Connect(function(character)
    if not scriptActivated then return end
    if speedHackEnabled then
        local humanoid = character:WaitForChild("Humanoid")
        humanoid.WalkSpeed = currentSpeed
    end
    
    local humanoid = character:WaitForChild("Humanoid")
    if not speedHackEnabled then
        originalSpeed = humanoid.WalkSpeed
    end
end)

-- Loop principal
local lastCheck = 0
local lastESPUpdate = 0

RunService.Heartbeat:Connect(function()
    if not scriptActivated then return end
    
    local currentTime = tick()
    
    -- Atualizar ESP
    if espEnabled and currentTime - lastESPUpdate >= 1 then
        lastESPUpdate = currentTime
        for _, anim in ipairs(animatronics) do
            local success, obj = pcall(function()
                local animFolder = Workspace:FindFirstChild("Animatronics")
                if not animFolder then return nil end
                
                local animObj = animFolder:FindFirstChild(anim.name)
                if not animObj then return nil end
                
                local targetObj = animObj:FindFirstChild(anim.target)
                
                if not targetObj then
                    local waypoints = animObj:FindFirstChild("Waypoints")
                    if waypoints then
                        targetObj = waypoints:FindFirstChild(anim.target)
                    end
                end
                
                if not targetObj then
                    for _, child in ipairs(animObj:GetDescendants()) do
                        if child.Name == anim.target then
                            targetObj = child
                            break
                        end
                    end
                end
                
                return targetObj
            end)
            
            if success and obj and not highlights[obj] then
                createHighlight(obj, anim.name)
            end
        end
    end
    
    -- Verificar portas
    if currentTime - lastCheck >= 0.5 then
        lastCheck = currentTime
        runAutoDoorCheck()
    end
    
    -- Manter velocidade ativa
    if speedHackEnabled then
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid and humanoid.WalkSpeed ~= currentSpeed then
                humanoid.WalkSpeed = currentSpeed
            end
        end
    end
    
    -- Monitoramento contínuo Anti-Jumpscare
    if antiJumpscareEnabled then
        local jumpscareFolder = Workspace:FindFirstChild("GameTriggers")
        if jumpscareFolder then
            local jumpscares = jumpscareFolder:FindFirstChild("Jumpscares")
            if jumpscares then
                for _, animName in ipairs(animatronicsWithJumpscares) do
                    local animJumpscare = jumpscares:FindFirstChild(animName)
                    if animJumpscare then
                        for _, obj in ipairs(animJumpscare:GetDescendants()) do
                            if obj:IsA("BasePart") then
                                if obj.CanTouch or obj.CanCollide or obj.Transparency < 1 then
                                    obj.CanCollide = false
                                    obj.CanTouch = false
                                    obj.Transparency = 1
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end)

-- ФУНКЦИЯ НАСТРОЙКИ КНОПОК (ВЫЗЫВАЕТСЯ ТОЛЬКО ПОСЛЕ АКТИВАЦИИ)
function setupButtonsAfterActivation()
    -- Подключаем основные кнопки
    ToggleESPBtn.MouseButton1Click:Connect(function()
        toggleESP()
    end)
    
    ToggleFullbrightBtn.MouseButton1Click:Connect(function()
        toggleFullbright()
    end)
    
    ToggleAutoDoorBtn.MouseButton1Click:Connect(function()
        toggleAutoDoor()
    end)
    
    ToggleAntiJumpscareBtn.MouseButton1Click:Connect(function()
        toggleAntiJumpscare()
    end)
    
    SpeedToggleBtn.MouseButton1Click:Connect(function()
        if speedHackEnabled then
            resetSpeed()
        else
            applySpeed()
        end
    end)
    
    ConfigBtn.MouseButton1Click:Connect(function()
        ConfigFrame.Visible = true
    end)
    
    CloseConfigBtn.MouseButton1Click:Connect(function()
        ConfigFrame.Visible = false
    end)
    
    ApplyConfigBtn.MouseButton1Click:Connect(function()
        applyConfig()
    end)
    
    ResetConfigBtn.MouseButton1Click:Connect(function()
        resetConfig()
    end)
    
    -- КНОПКА ПЕРЕКЛЮЧЕНИЯ ЯЗЫКА
    LanguageBtn.MouseButton1Click:Connect(function()
        switchLanguage()
    end)
    
    -- Minimize button
    local minimized = false
    local originalSize = UDim2.new(0, 240, 0, 380)
    local minimizedSize = UDim2.new(0, 240, 0, 30)
    
    MinimizeBtn.MouseButton1Click:Connect(function()
        if not scriptActivated then return end
        minimized = not minimized
        local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            Size = minimized and minimizedSize or originalSize
        })
        tween:Play()
        
        MinimizeBtn.Text = minimized and "+" or "−"
        
        task.wait(0.1)
        ToggleESPBtn.Visible = not minimized
        ToggleFullbrightBtn.Visible = not minimized
        ToggleAutoDoorBtn.Visible = not minimized
        ToggleAntiJumpscareBtn.Visible = not minimized
        SpeedFrame.Visible = not minimized
        ConfigBtn.Visible = not minimized
        StatusLabel.Visible = not minimized
        YTLabel.Visible = not minimized
    end)
    
    CloseBtn.MouseButton1Click:Connect(function()
        if not scriptActivated then return end
        for obj, _ in pairs(highlights) do
            removeHighlight(obj)
        end
        if fullbrightEnabled then
            toggleFullbright()
        end
        if speedHackEnabled then
            resetSpeed()
        end
        if antiJumpscareEnabled then
            enableJumpscares()
        end
        
        local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        })
        tween:Play()
        tween.Completed:Connect(function()
            ScreenGui:Destroy()
        end)
    end)
    
    -- Добавляем эффекты наведения
    local function addHoverEffect(button)
        if not UserInputService.TouchEnabled then
            button.MouseEnter:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                    BackgroundTransparency = 0.1
                }):Play()
            end)
            
            button.MouseLeave:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                    BackgroundTransparency = 0.3
                }):Play()
            end)
        end
    end
    
    -- Добавляем эффекты наведения для основных кнопок
    addHoverEffect(ToggleESPBtn)
    addHoverEffect(ToggleFullbrightBtn)
    addHoverEffect(ToggleAutoDoorBtn)
    addHoverEffect(ToggleAntiJumpscareBtn)
    addHoverEffect(SpeedToggleBtn)
    addHoverEffect(ConfigBtn)
    addHoverEffect(LanguageBtn)
    addHoverEffect(MinimizeBtn)
    addHoverEffect(CloseBtn)
    addHoverEffect(ApplyConfigBtn)
    addHoverEffect(ResetConfigBtn)
    
    print("Buttons set up successfully!")
end

-- Показываем только окно активации при запуске
KeyFrame.Visible = true
MainFrame.Visible = false

-- Инициализируем начальные тексты
updateAllTexts()

print("FNAF 1 Script v1.8.0 loaded - Activation required")
print("Key: " .. REQUIRED_KEY)
